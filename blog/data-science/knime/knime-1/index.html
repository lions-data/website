<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Lions Data, Ltd.">
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>KNIME 入門編 / 前処理 - Lions Data's Blog</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "KNIME \u5165\u9580\u7de8 / \u524d\u51e6\u7406", url: "#_top", children: [
              {title: "\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u5168\u4f53", url: "#_1" },
              {title: "\u9867\u5ba2\u30de\u30b9\u30bf \u524d\u51e6\u7406", url: "#_2" },
              {title: "\u58f2\u4e0a\u30c7\u30fc\u30bf \u524d\u51e6\u7406", url: "#_3" },
              {title: "\u4f7f\u7528\u30ce\u30fc\u30c9\u4e00\u89a7", url: "#_4" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../knime-2/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../knime-2/" class="btn btn-xs btn-link">
        KNIME 入門編 / 探索的データ分析
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../" class="btn btn-xs btn-link">
        KNIME 概要
      </a>
    </div>
    
  </div>

    

    <h2 id="knime">KNIME 入門編 / 前処理</h2>
<ul>
<li>作成日: 2020-03-31</li>
<li>更新日: 2020-04-11</li>
</ul>
<p>ビッグデータでは、大量のテキストデータ、数値データを扱います。数値データには、欠損値、異常値などを含む為、そのままデータ分析を進めても期待した結果・効果を得ることができません。データ分析では、データの誤り、漏れ、不足、矛盾を事前にチェックし、データを整える「前処理」という工程が必要とされています。今回は、顧客マスタと売上データの二つのデータの前処理を行います。その結果をCSV形式ファイルに保存し、次回の探索的データ分析 <em>(可視化含む)</em> に進みます。</p>
<h3 id="_1">ワークフロー全体</h3>
<ol>
<li>顧客マスタ データ処理</li>
<li>売上データ データ処理</li>
<li>顧客マスタ, 売上データ結合</li>
<li>CSV形式ファイル出力</li>
</ol>
<p>ワークフローは下の図に示した通りです。<strong>顧客マスタ</strong> と <strong>売上データ</strong> の前処理ワークフローを <code>META_顧客マスタ W/F</code> と <code>META_売上データ W/F</code> にそれぞれまとめ、その後、<strong>前処理後の二つのテーブルを結合</strong>します。最終的に、結合したレコードを<strong>CSV形式ファイルとして出力</strong>します。</p>
<p><em>Fig. 全体ワークフロー</em></p>
<p><img alt="ワークフロー" src="../images/knime-1/parent_wf/workflow.png" /></p>
<h4 id="meta_-meta_"><code>META_顧客マスタ</code> と <code>META_売上データ</code> の結合</h4>
<p><code>META_顧客マスタ W/F</code> と <code>META_売上データ W/F</code> の出力 <em>(レコード)</em> を結合します。結合するカラムは、<code>顧客名</code> です。</p>
<p><em>Fig. テーブル結合</em></p>
<p><img alt="ワークフロー" src="../images/knime-1/parent_wf/window_1.png" /></p>
<ul>
<li>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.joiner.Joiner2NodeFactory">Manipulation / Column / Split &amp; Combine / Joiner</a></li>
</ul>
<h4 id="csv">CSV形式ファイルの出力</h4>
<p>最終的に得られたレコードをCSV形式ファイルとして出力します。</p>
<ol>
<li>出力先とファイル名を指定する</li>
<li>ファイルが既に存在している時、上書きを指定する</li>
</ol>
<p><em>Fig. CSV形式ファイル出力</em></p>
<p><img alt="ワークフロー" src="../images/knime-1/parent_wf/window_2.png" /></p>
<ul>
<li>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.io.csvwriter.CSVWriterNodeFactory">IO / Write / CSV Writer</a></li>
</ul>
<h3 id="_2">顧客マスタ 前処理</h3>
<p>処理概要:</p>
<ul>
<li>データ読込み:<ul>
<li><code>顧客マスター</code> Excelファイル 読込み</li>
</ul>
</li>
<li>前処理:<ul>
<li><code>氏名</code> スペース除去</li>
<li><code>登録日</code><ul>
<li>データ型統一</li>
<li><em>Excel シリアル値</em> を日付型に変換</li>
<li>レコードマージ</li>
</ul>
</li>
</ul>
</li>
<li>データ出力:<ul>
<li>データ処理後 <code>顧客マスター</code> CSV形式ファイル出力 <em>(再利用)</em></li>
</ul>
</li>
</ul>
<p><em>Fig. 顧客マスタ.前処理ワークフロー</em></p>
<p><img alt="顧客マスタ.前処理ワークフロー" src="../images/knime-1/customer_master_wf/workflow.png" /></p>
<h4 id="1-excel">1. 顧客マスター Excelファイル 読込み</h4>
<p>KNIMEに 顧客マスターファイル <em>(Excel)</em> を読み込み、レコードを確認します。</p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_1_1.png" /></p>
<ol>
<li>ローカルファイル上にある <code>顧客マスター Excelファイル</code> を指定する</li>
<li>
<p>Excelファイルの読み込み成功後、データプレビューエリアにレコードが表示される</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.ext.poi2.node.read4.XLSReaderNodeFactory">IO / Read / Excel Reader</a></p>
</li>
</ol>
<h4 id="2-1">2-1. 顧客マスター 前処理 / 氏名カラム / スペース除去</h4>
<p>顧客マスター.登録日カラムのフォーマットを統一する為、不要なスペース <em>(Whitespace)</em> を除去します。</p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_2_1.png" /></p>
<ol>
<li><code>replace関数</code> を使い <code>" "</code> スペースを除去する</li>
<li>
<p>既存の列, 顧客名を指定し、処理結果を上書きする</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.stringmanipulation.StringManipulationNodeFactory">Manipulation / Column / Convert &amp; Replace / String Manipulation</a></p>
</li>
</ol>
<h4 id="2-2">2-2. 顧客マスター 前処理 / 登録日カラム / 日付フォーマット判定 + レコード分割</h4>
<p><code>登録日</code> カラムの値が 期待する日付フォーマットと それ以外に分類します。</p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_2_2_1.png" /></p>
<ol>
<li>検査対象カラムに　<code>登録日</code> を指定する</li>
<li>
<p>期待する日付フォーマットを 正規表現 - <code>^(\d{4})/(\d{2})/(\d{2})$</code> を指定する</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.filter.row.RowFilter2PortNodeFactory">Manipulation / Row / Filter / Row Splitter</a></p>
</li>
</ol>
<h5 id="filtered-out">除外レコード (Filtered Out)</h5>
<p>ノードアイコン を選択し、処理メニューの中の <strong>Filtered Out</strong> を実行することで、除外レコード <em>(期待する日付フォーマット以外)</em> のレコードが表示されます。</p>
<p><em>Fig. 処理メニュー</em></p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_2_2_2.png" /></p>
<p><em>Fig. 除外レコード表</em></p>
<p><code>登録日</code> カラムの値が <code>reserved-*x1F</code> となっていて 日付フォーマットでないことが確認できます。</p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_2_2_3.png" /></p>
<h4 id="2-3">2-3. 顧客マスター 前処理 / 登録日カラム / 文字列置換</h4>
<p>「2-1. 顧客マスター 前処理 / 氏名カラム / スペース除去」と同様に <code>String Manipulation</code> ノードを使って、文字列置換を行う - 値から 文字列 <code>reserved-</code> と <code>x1F</code> を除去します。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">$登録日$</span><span class="p">,</span> <span class="s">&quot;reserved-&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">),</span> <span class="s">&quot;x1F&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<ul>
<li>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.stringmanipulation.StringManipulationNodeFactory">Manipulation / Column / Convert &amp; Replace / String Manipulation</a></li>
</ul>
<h4 id="2-4">2-4. 顧客マスター 前処理 / 登録日カラム / 文字列から数値へ変換</h4>
<p>前のノード - 「2-3. 顧客マスター 前処理 / 登録日カラム / 文字列置換」で <code>登録日</code> から不要な文字列を除去し、シリアル値 <em>(文字列)</em> に整形したので、それを数値に変換すます。</p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_2_4.png" /></p>
<ul>
<li>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.colconvert.stringtonumber2.StringToNumber2NodeFactory">Manipulation / Column / Convert &amp; Replace / String To Number</a></li>
</ul>
<h4 id="2-5-java-unix-timestamp">2-5. 顧客マスター 前処理 / 登録日カラム / Javaコード - シリアル値からUnix Timestampへ変換</h4>
<p>前のノード - 「2-4. 顧客マスター 前処理 / 登録日カラム / 文字列から数値へ変換」で <code>登録日</code> のシリアル値を得ることができたので、さらにその値を Unix Timestampに変換します。</p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_2_5.png" /></p>
<ol>
<li>シリアル値からUnix Timestampに変換するJavaコードを記述する</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// Enter your code here:</span>
<span class="n">out_RegisterdAt</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_RegisterdAt</span> <span class="o">-</span> <span class="mi">25569</span><span class="p">)</span> <span class="o">*</span> <span class="mi">86400</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<ol>
<li>
<p>Javaからレコードにアクセス可能にする為、Inputエリアに <code>登録日</code>カラムを指定し、データ型: Integer, Java Field: <code>c_RegisteredAt</code> とする。また、シリアル値からUnix Timestampに変換した値を <code>登録日</code> カラムに上書きする <em>(Outputエリアで設定する)</em></p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.jsnippet.JavaSnippetNodeFactory">Scripting / Java / Java Snipet</a></p>
</li>
</ol>
<h4 id="2-6-unix-timestamp">2-6. 顧客マスター 前処理 / 登録日カラム / Unix Timestampから日付型へ変換</h4>
<p>前のノード - 「2-5. 顧客マスター 前処理 / 登録日カラム / Javaコード - シリアル値からUnix Timestampへ変換」で <code>登録日</code> の Unix Timestampの値を得ることができたので、日付型に変換します。</p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_2_6.png" /></p>
<ol>
<li>Includeエリアで <code>登録日</code> カラムを指定する</li>
<li>
<p>入力列の単位、出力列のデータ型 - <code>Date</code> を指定する</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.time.node.convert.timestamptodatetime.TimestampToDateTimeNodeFactory">Other / Data Types / Time Series / Transform / UNIX Timestamp to Date&amp;Time</a></p>
</li>
</ol>
<h4 id="2-7">2-7. 顧客マスター 前処理 / レコード結合</h4>
<p><code>登録日</code> カラムの不正な値を日付型に修正したレコードと、最初から日付型のレコードを結合し、データ分析用のレコードセットを作成する。処理後のレコードは、<code>Concatenated table</code> を実行することで確認することができます。</p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_2_7_1.png" /></p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_2_7_2.png" /></p>
<ul>
<li>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.append.row.AppendedRowsNodeFactory">Manipulation / Row / Transform / Concatenate</a></li>
</ul>
<h4 id="3">3. データ処理後 ファイル出力</h4>
<p>前処理を完了したレコードをCSV形式で保存しておくことで、再利用することができる。ファイルの保存先を指定し、既に同名称のファイルが存在する時は、上書きするように <code>If file exists...: Overwrite(上書き)</code> を指定します。</p>
<p><img alt="" src="../images/knime-1/customer_master_wf/window_2_8.png" /></p>
<ul>
<li>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.io.csvwriter.CSVWriterNodeFactory">IO / Write / CSV Writer</a></li>
</ul>
<h3 id="_3">売上データ 前処理</h3>
<p>処理概要:</p>
<ul>
<li>データ読込み:<ul>
<li><code>売上データ</code> CSV形式ファイル 読込み</li>
</ul>
</li>
<li>前処理:<ul>
<li><code>購買日</code><ul>
<li>RowIDを元に、<code>購買日</code> 列追加</li>
<li>データ型統一 文字列から日付型へ</li>
<li><code>購買日</code> を元に、<code>購買年月</code> 列追加</li>
</ul>
</li>
<li><code>商品名</code>  スペース除去 <em>(文字列処理)</em></li>
<li><code>商品価格</code><ul>
<li>欠損値処理<ul>
<li>欠損値存在レコード, 未存在レコード 分割</li>
<li>欠損値置換値 算出と置換</li>
<li>レコード結合, 欠損値処理済レコードと欠損値処理対象外レコード</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><em>Fig. 売上データ.前処理wワークフロー</em></p>
<p><img alt="売上データ.前処理ワークフロー" src="../images/knime-1/sales_data_wf/workflow.png" /></p>
<h4 id="1-csv">1. 売上データ CSVファイル 読込み</h4>
<p>KNIMEに 売上データファイル <em>(CSV)</em> を読み込み、レコードを確認します。</p>
<ol>
<li>ローカルファイル上にある <code>売上データ CSVファイル</code> を指定する</li>
<li>
<p>CSVファイルの読み込み成功後、データプレビューエリアにレコードが表示される</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.io.csvreader.CSVReaderNodeFactory">IO / Read / CSV Reader</a></p>
</li>
<li>参考: <a href="#1-顧客マスター-excelファイル-読込み">顧客マスタ 前処理 / 1. 顧客マスター Excelファイル 読込み</a></li>
</ol>
<h4 id="2-1_1">2-1. 売上データ 前処理 / 購買日 / カラム追加</h4>
<p>KNIMEでは、先頭カラムを<code>RowID</code>にする為、RowIDを元に <code>購買日</code> カラムを追加します。処理結果に <code>購買日</code>カラムが追加されていることを確認します。</p>
<p><em>Fig. RowIDを元にカラム追加</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_1_1.png" /></p>
<p><em>Fig. カラム追加後レコード</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_1_2.png" /></p>
<ol>
<li>新しい列名 - <code>purchase_date (購買日)</code> を指定する</li>
<li>
<p>新しい列 - <code>purchase_date (購買日)</code> の存在を確認する</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.rowkey2.RowKeyNodeFactory2">Manipulation / Row / Other / RowID</a></p>
</li>
</ol>
<h4 id="2-2_1">2-2. 売上データ 前処理 / 購買日 / データ型変更</h4>
<p><code>購買日</code>カラムのデータ型を文字列から日付に変更します</p>
<p><em>Fig. 文字列から日付に変換</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_2_1.png" /></p>
<ol>
<li>Includeエリアで <code>purchase_date (購買日)</code> のみを指定する</li>
<li>
<p>変換するデータ型: <code>Date</code>、日付フォーマット: <code>yyyy-MM-dd HH:mm:ss</code>、Locale <em>(地域)</em>:  <code>ja-JP</code> を指定する</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.time.node.convert.stringtodatetime.StringToDateTimeNodeFactory">Other Data Types / Time Series /Transform / String to Date&amp;Time</a></p>
</li>
</ol>
<h4 id="2-3_1">2-3. 売上データ 前処理 / 購買年月 / カラム作成</h4>
<p><code>購買日</code>カラムを元に <code>購買年月</code>カラムを作成し、集計時の集計項目として利用します</p>
<p><em>Fig. 購買日カラムから購買年月カラムを作成</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_3_1.png" /></p>
<ol>
<li>Includeエリアに <code>purchase_date (購買日)</code> のみを指定する</li>
<li>
<p>日付フォーマット: <code>yyyy-MM</code> を指定する</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.time.node.convert.datetimetostring.DateTimeToStringNodeFactory">Other Data Types / Time Series /Transform / Date&amp;Time to String</a></p>
</li>
</ol>
<h4 id="2-4_1">2-4. 売上データ 前処理 / 購買年月 / カラム名変更</h4>
<p><code>購買年月</code>カラムを正しい名称に変更します</p>
<p><em>Fig. 購買年月カラム名 変更</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_4_1.png" /></p>
<ol>
<li>変更対象列 - <code>purchase_date(String)</code> を指定する</li>
<li>
<p>変更後の列名 <code>purchase_year_month</code>, データ型: <code>StringValue</code> を指定する</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.time.node.convert.datetimetostring.DateTimeToStringNodeFactory">Other Data Types / Time Series /Transform / Date&amp;Time to String</a></p>
</li>
</ol>
<h4 id="2-5">2-5. 売上データ 前処理 / 商品名 / スペース除去等 (文字列処理)</h4>
<p>各レコードの <code>商品名</code>の値が統一されていない為、<code>商品名</code> カラムの値を整形します</p>
<ul>
<li>スペース除去</li>
<li>文字を大文字に統一</li>
</ul>
<p><em>Fig. 商品名 文字列処理</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_5_1.png" /></p>
<ol>
<li>Javaコードを記述する</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">replace</span><span class="p">(</span>
    <span class="n">upperCase</span><span class="p">(</span><span class="n">$item_name$</span><span class="p">),</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<ol>
<li>
<p>上書きする列 - <code>item_name (商品名)</code> を選択する</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.stringmanipulation.StringManipulationNodeFactory">Manipulation / Column / Convert &amp; Replace / String Manipulation</a></p>
</li>
</ol>
<h4 id="2-6">2-6. 売上データ 前処理 / 商品価格 / 欠損値レコード抽出</h4>
<p>商品価格カラムの <code>欠損値</code> のレコードを抽出し、除外されたレコード <em>(正しいレコード)</em> を元に欠損値を置換する値を 「2-7」からの処理で算出します。抽出した <code>欠損値</code> を保有するレコードを確認します。</p>
<p><em>Fig. レコード分割 - 欠損値レコード抽出</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_6_1.png" /></p>
<ol>
<li><code>item_price (商品名)</code> を欠損値判定カラムに指定する</li>
<li>判定処理 <code>only missing value match (欠損値のみに該当)</code> を指定する</li>
</ol>
<p><em>Fig. レコード分割 - 欠損値レコード</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_6_2.png" /></p>
<ol>
<li>
<p>実行結果のテーブルを確認し、<code>item_price</code> カラムが全て <code>?</code> であることを確認する</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.filter.row.RowFilter2PortNodeFactory">Manipulation / Row / Filter / Row Splitter</a></p>
</li>
</ol>
<h4 id="2-7_1">2-7. 売上データ 前処理 / 商品別 商品価格 平均算出</h4>
<p><code>item_name (商品名)</code> 別 <code>item_price (商品価格)</code> の平均値を算出します。</p>
<p><em>Fig. 商品別 商品価格 平均算出</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_7_1.png" /></p>
<ol>
<li>Groupエリアに <code>item_name (商品名)</code> を指定する</li>
</ol>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_7_2.png" /></p>
<ol>
<li>
<p>集計対象カラムと計算方法 - <code>item_price (商品価格)</code> の平均を指定する</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.groupby.GroupByNodeFactory">Manipulation / Row / Transform / GroupBy</a></p>
</li>
</ol>
<h4 id="2-8-1">2-8. 売上データ 前処理 / 商品別 商品価格 置換-1 (テーブル連結)</h4>
<p>「2-2. 欠損値抽出されたレコード」 と 「2-7. 欠損値を補完するレコード」を結合します。<code>Mean(item_price)</code> カラムが欠損値を補完する値になります。</p>
<p><em>Fig. テーブル結合 - 商品価格に欠損値が存在したレコード</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_8_1.png" /></p>
<ol>
<li>結合するカラムに <code>item_name (商品名)</code> を指定する</li>
</ol>
<p><em>Fig. テーブル結合後レコード</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_8_2.png" /></p>
<ol>
<li>
<p>結合処理実行後のテーブルを確認する</p>
</li>
<li>
<p>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.joiner.Joiner2NodeFactory">Manipulation / Column / Split &amp; Combine / Joiner</a></p>
</li>
</ol>
<h4 id="2-9-2">2-9. 売上データ 前処理 / 商品別 商品価格 置換-2 (不要カラム削除)</h4>
<p><code>item_price (商品価格)</code> カラムを削除対象に指定し、<code>Mean(item_price) (平均商品価格)</code> カラムを残します。</p>
<p><em>Fig. カラムフィルター / 不要カラム削除</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_9_1.png" /></p>
<ul>
<li>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.filter.column.DataColumnSpecFilterNodeFactory">Manipulation / Column / Filter / Column Filter</a></li>
</ul>
<h4 id="2-10-2">2-10. 売上データ 前処理 / 商品別 商品価格 置換-2 (カラム名変更)</h4>
<p>テーブル結合した後の <code>Mean(item_price) (平均商品価格)</code> カラムの名称を <code>item_price (商品価格)</code> 変更します。</p>
<p><em>Fig. カラム名変更</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_10_1.png" /></p>
<ul>
<li>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.rename.RenameNodeFactory">Manipulation / Column / Convert &amp; Replace / Column Rename</a></li>
</ul>
<h4 id="2-11">2-11. 売上データ 前処理 / 商品価格 / 欠損値置換</h4>
<p>「2-2. 欠損値レコード抽出処理」で 欠損値処理対象外レコードと、「2-10. 欠損値処理を行なったレコード」を一つのテーブルにします。</p>
<p><em>Fig. レコード結合</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_11_1.png" /></p>
<p><em>Fig. レコード結合 結果</em></p>
<p><img alt="" src="../images/knime-1/sales_data_wf/window_2_11_2.png" /></p>
<p>結合処理実行後のテーブルを確認する</p>
<ul>
<li>利用ノード: <a href="https://nodepit.com/node/org.knime.base.node.preproc.append.row.AppendedRowsNodeFactory">Manipulation / Row / Transform / Concatenate</a></li>
</ul>
<h3 id="_4">使用ノード一覧</h3>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">アイコン</th>
<th align="left">機能</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.ext.poi2.node.read4.XLSReaderNodeFactory">Excel Reader</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_io_excel_reader.png" /></td>
<td align="left">Excel スプレッドシートをの1つのシートからデータのみを読み取ります。数値、日付、ブール値、文字列のデータのみを読み取ることができます。図、写真、その他のアイテムは読み取ることができません</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.io.csvreader.CSVReaderNodeFactory">CSV Reader</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_io_csv_reader.png" /></td>
<td align="left">CSVファイルを読み取ります。ノードが実行されると、入力ファイルをスキャンして列の数とタイプを決定し、自動推測された構造を持つテーブルを出力します</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.io.csvwriter.CSVWriterNodeFactory">CSV Writer</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_io_csv_writer.png" /></td>
<td align="left">入力データテーブルをファイルまたはURLで示されるリモートの場所にCSVフォーマットで書き込みます</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.preproc.stringmanipulation.StringManipulationNodeFactory">String Manipulation</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_string_manipulation.png" /></td>
<td align="left">検索と置換、大文字と小文字の区別、先頭と末尾の空白などの文字列を操作します</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.preproc.colconvert.stringtonumber2.StringToNumber2NodeFactory">String To Number</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_string_to_number.png" /></td>
<td align="left">列 <em>(または列のセット)</em> 内の文字列を数値に変換します</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.preproc.rename.RenameNodeFactory">Column Rename</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_column_rename.png" /></td>
<td align="left">列名を変更するか、そのタイプを変更します</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.time.node.convert.timestamptodatetime.TimestampToDateTimeNodeFactory">Unix Timestamp To Date Time</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_unix_timestamp_to_datetime.png" /></td>
<td align="left">エポック <em>(1970年1月1日)</em> 以降の秒単位、ミリ秒単位、マイクロ秒単位、またはナノ秒単位のUNIXタイムスタンプでなければなりません。出力は、ローカルとゾーンの日付と時刻の形式を選択し、必要に応じてタイムゾーンを追加できます</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.time.node.convert.datetimetostring.DateTimeToStringNodeFactory">Date Time To String</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_datetime_to_string.png" /></td>
<td align="left">DateTimeFormatterで定義されているユーザー指定のフォーマットパターンを使用して、Date＆Time列の時刻値を文字列に変換します</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.time.node.convert.stringtodatetime.StringToDateTimeNodeFactory">String To Date Time</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_string_to_datetime.png" /></td>
<td align="left">文字列を解析し、指定されたフォーマットパターンを使用して日付と時刻のセルに変換します。日付には、月や曜日の名前などのローカライズされた用語が含まれる場合があるのでロケールを選択できます</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.preproc.filter.row.RowFilter2PortNodeFactory">Row Splitter</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_row_splitter_1.png" /></td>
<td align="left"><code>Row Filter</code> とまったく同じ機能を備えています。パフォーマンスとディスク容量の理由から、行フィルターノードの使用を検討する必要があります</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.preproc.rowkey2.RowKeyNodeFactory2">RowID</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_row_id.png" /></td>
<td align="left">入力データの <code>RowID</code> を別の列の値 <em>(値を文字列に変換すること)</em> にすることができます <em>(列を新規に作成することも可能)</em></td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.preproc.append.row.AppendedRowsNodeFactory">Concatenate</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_row_concatenate.png" /></td>
<td align="left">2つのテーブルを連結します</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.preproc.groupby.GroupByNodeFactory">Group By</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_group_by.png" /></td>
<td align="left">選択したグループ列の一意の値でテーブルの行をグループ化します。選択したグループ列の値の一意のセットごとに行が作成されます。残りの列は、指定した集計設定に基づいて集計されます</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.preproc.filter.column.DataColumnSpecFilterNodeFactory">Column Filter</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_column_filter.png" /></td>
<td align="left">入力テーブルの不要な列を出力テーブルから除外します</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.preproc.joiner.Joiner2NodeFactory">Joiner</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_joiner.png" /></td>
<td align="left">データベースのような方法で2つのテーブルを結合します (<code>inner join</code>, <code>left outer join</code> , <code>right outer join</code>, <code>full outer join</code> のいずれかを指定する)</td>
</tr>
<tr>
<td align="center"><a href="https://nodepit.com/node/org.knime.base.node.jsnippet.JavaSnippetNodeFactory">Java Snipet</a></td>
<td align="center"><img alt="" src="../images/knime-1/node_icons/node_java_snipet.png" /></td>
<td align="left">任意のJavaコードを実行して、新しい列を作成したり、既存の列を置き換えたりできます</td>
</tr>
</tbody>
</table>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../knime-2/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../knime-2/" class="btn btn-xs btn-link">
        KNIME 入門編 / 探索的データ分析
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../" class="btn btn-xs btn-link">
        KNIME 概要
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content"><p>(c) 2020 Lions Data, Ltd. All rights reserved.</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>